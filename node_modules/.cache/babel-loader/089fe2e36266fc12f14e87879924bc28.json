{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Documents/React/workspace/src/FrontEnd/Container/Scrap.js\";\nimport React from 'react';\nimport './Scrap.css';\nimport { Row, Col, Layout, Button } from 'antd';\nimport { List, Icon, Popover, Avatar, InputNumber, notification } from 'antd';\nimport axios from 'axios';\nimport NumericInput from '../Components/InputNumber';\nimport { BrowserRouter as Router, Redirect } from \"react-router-dom\";\nimport moment from 'moment';\nimport baseURL from '../Components/AxiosAPI';\nimport InfoIcom from '../Components/InfoIcon';\nconst Header = Layout.Header,\n      Content = Layout.Content;\n\nconst openNotificationWithIcon = type => {\n  notification[type]({\n    message: '上傳成功'\n  });\n};\n\nvar income = ['營業額'];\n\nclass UserPage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.ScrapValueStore = (item, Num) => {\n      const data = this.state.data;\n      console.log('order:', Num);\n      data.forEach(data => {\n        if (data.key === item.key) {\n          data.scrap = Num;\n        }\n      });\n      this.setState({\n        data\n      });\n    };\n\n    this.state = {\n      isAuth: '',\n      UploadDisable: true,\n      data: '',\n      Shop: '',\n      Name: '',\n      Branch: '',\n      Permission: '',\n      Display: false,\n      MainPage: false\n    };\n  }\n\n  LogoutFunction() {\n    this.setState({\n      isAuth: 'false'\n    });\n    window.sessionStorage.setItem('isAuth', 'false');\n  }\n\n  MainFnction(e) {\n    this.setState({\n      MainPage: true\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          data = _this$state.data,\n          isAuth = _this$state.isAuth,\n          MainPage = _this$state.MainPage;\n\n    if (isAuth === 'false') {\n      console.log('logout');\n      return React.createElement(Redirect, {\n        to: '/',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59\n        },\n        __self: this\n      });\n    } else if (MainPage === true) {\n      return React.createElement(Redirect, {\n        to: 'Main',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      });\n    }\n\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }, React.createElement(Layout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, React.createElement(Col, {\n      span: 24,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, React.createElement(Header, {\n      className: \"Header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }, React.createElement(InfoIcom, {\n      name: window.localStorage.getItem('name'),\n      branch: window.localStorage.getItem('branch'),\n      permission: window.sessionStorage.getItem('permission'),\n      shape: \"circle\",\n      size: 60,\n      logout: () => this.LogoutFunction(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }), React.createElement(Icon, {\n      type: \"line-chart\",\n      className: \"analyze\",\n      style: {\n        fontSize: '1cm',\n        color: '#08c'\n      },\n      onClick: this.MainFnction.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    })))), React.createElement(Col, {\n      span: 24,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, React.createElement(Content, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"Content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"ListName\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, React.createElement(List, {\n      bordered: true,\n      dataSource: data,\n      renderItem: item => React.createElement(List.Item, {\n        key: item.key,\n        actions: [React.createElement(InputNumber, {\n          key: item.key,\n          className: \"Scrap\",\n          value: item.scrap,\n          placeholder: \"\\u53EB\\u8CA8\",\n          onChange: value => this.ScrapValueStore(item, value),\n          decimalSeparator: \".\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        })],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, item.title),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    })), React.createElement(Button, {\n      type: \"danger\",\n      className: \"Upload\",\n      onClick: this.UploadFunction.bind(this),\n      icon: \"delete\",\n      size: \"large\",\n      style: {\n        fontSize: '0.7cm'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    })))))));\n  }\n\n  UploadFunction(event) {\n    console.log(this.state.Shop);\n    axios.post(baseURL + '/ShopData/add', {\n      shopname: this.state.Shop,\n      branch: this.state.Branch,\n      name: this.state.Name,\n      date: moment().format('YYYY-MM-DD'),\n      time: moment().format('hh:mm'),\n      stock: this.state.data\n    }).then(response => {\n      console.log(response);\n      window.sessionStorage.setItem('lastupload', moment().format('YYYY-MM-DD'));\n      openNotificationWithIcon('success'); //set last upload date\n\n      /* axios.put(baseURL+'/User/updateUploaddate/'+window.sessionStorage.getItem('auto_increment'),{\n         date:moment().format('YYYY-MM-DD')\n       })\n       .then( (response) => {\n         console.log(response);\n       })\n       .catch( (error) => {\n         console.log(error);\n       });*/\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  componentWillMount() {\n    console.log('componentWillMount');\n    axios.get(baseURL + '/ShopData/getLastStock', {\n      params: {\n        shop: window.localStorage.getItem('shopname'),\n        branch: window.localStorage.getItem('branch')\n      }\n    }).then(response => {\n      for (var index in response.data) {\n        response.data[index].scrap = 0;\n      }\n\n      this.setState({\n        data: response.data,\n        Shop: window.localStorage.getItem('shopname'),\n        Name: window.localStorage.getItem('name'),\n        Branch: window.localStorage.getItem('branch'),\n        isAuth: window.sessionStorage.getItem('isAuth'),\n        Permission: window.sessionStorage.getItem('permission')\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n    axios.get(baseURL + '/ShopData/getLastExpense', {\n      params: {\n        shop: window.localStorage.getItem('shopname'),\n        branch: window.localStorage.getItem('branch')\n      }\n    }).then(response => {\n      for (var index in response.data) {\n        response.data[index].cost = 0;\n      }\n\n      this.setState({\n        expense: response.data\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n    this.setState({\n      UploadDisable: false\n    });\n  }\n\n  componentDidMount() {\n    console.log('componentdDidMount');\n    console.log(moment().format('YYYY-MM-DD hh:mm'));\n  }\n\n  componentDidUpdate() {\n    console.log('componentDidUpdate');\n  }\n\n}\n\nexport default UserPage;","map":{"version":3,"sources":["/Users/mac/Documents/React/workspace/src/FrontEnd/Container/Scrap.js"],"names":["React","Row","Col","Layout","Button","List","Icon","Popover","Avatar","InputNumber","notification","axios","NumericInput","BrowserRouter","Router","Redirect","moment","baseURL","InfoIcom","Header","Content","openNotificationWithIcon","type","message","income","UserPage","Component","constructor","props","ScrapValueStore","item","Num","data","state","console","log","forEach","key","scrap","setState","isAuth","UploadDisable","Shop","Name","Branch","Permission","Display","MainPage","LogoutFunction","window","sessionStorage","setItem","MainFnction","e","render","localStorage","getItem","fontSize","color","bind","value","title","UploadFunction","event","post","shopname","branch","name","date","format","time","stock","then","response","catch","error","componentWillMount","get","params","shop","index","cost","expense","componentDidMount","componentDidUpdate"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './Scrap.css'\nimport { Row, Col, Layout, Button } from 'antd';\nimport { List, Icon, Popover, Avatar, InputNumber,notification } from 'antd';\nimport axios from 'axios'\nimport NumericInput from'../Components/InputNumber'\nimport {BrowserRouter as Router,Redirect,} from \"react-router-dom\";\nimport moment from 'moment';\nimport baseURL from '../Components/AxiosAPI'\nimport InfoIcom from '../Components/InfoIcon'\nconst { Header, Content } = Layout;\n\nconst openNotificationWithIcon = type => {\n  notification[type]({\n    message: '上傳成功',\n  });\n};\n\nvar income = [\n  '營業額'\n];\nclass UserPage extends React.Component{\n  constructor(props){\n    super(props);\n    this.state = {\n      isAuth: '',\n      UploadDisable:true,\n      data:'',\n      Shop:'',\n      Name:'',\n      Branch:'',\n      Permission:'',\n      Display:false,\n      MainPage:false\n    }      \n  }\n  LogoutFunction(){\n    this.setState({isAuth:'false'});\n    window.sessionStorage.setItem('isAuth','false');\n  }\n  ScrapValueStore = (item, Num)=>{\n    const {data} = this.state;\n    console.log('order:',Num);\n    data.forEach(data=>{\n      if(data.key === item.key){\n        data.scrap = Num\n      }\n    })\n    this.setState({ data });\n  }\n\n  MainFnction(e){\n    this.setState({MainPage:true})\n  }\n  render(){\n    const { data,isAuth,MainPage } = this.state;\n    if(isAuth === 'false'){\n      console.log('logout');\n      return <Redirect to={'/'} />\n    }else if(MainPage === true){\n      return <Redirect to={'Main'} />\n    }\n    return(\n      <div className=\"App\">\n        <Row>\n          <Layout>\n            <Col span={24}>\n              <Header className=\"Header\">\n                <div>\n                    <InfoIcom \n                        name={window.localStorage.getItem('name')}\n                        branch={window.localStorage.getItem('branch')}\n                        permission = {window.sessionStorage.getItem('permission')}\n                        shape='circle'\n                        size={60}\n                        logout={()=>this.LogoutFunction()}\n                    />\n                    <Icon type=\"line-chart\" className='analyze' style={{fontSize:'1cm',color:'#08c'}} onClick={this.MainFnction.bind(this)} />\n                </div>\n              </Header>\n            </Col>\n            <Col span={24}>\n              <Content>\n                <div className=\"Content\">\n                  <div className=\"ListName\">\n                    <List \n                      bordered\n                      dataSource={data}\n                      renderItem={item => (\n                        <List.Item key={item.key} actions={\n                          [<InputNumber key={item.key} className=\"Scrap\" value={item.scrap} placeholder=\"叫貨\" onChange={(value)=>this.ScrapValueStore(item,value)} decimalSeparator=\".\" />]\n                          }>\n                          {item.title}\n                        </List.Item>\n                      )}\n                    />\n                  </div>\n                  <Button type=\"danger\" className=\"Upload\"  onClick={this.UploadFunction.bind(this)} icon=\"delete\" size=\"large\" style={{fontSize:'0.7cm'}}></Button>\n                </div>\n              </Content>\n            </Col>\n          </Layout>\n        </Row>\n      </div>\n    )\n  }\n  UploadFunction(event){\n    console.log(this.state.Shop)\n    axios.post(baseURL+'/ShopData/add', {\n      shopname: this.state.Shop,\n      branch : this.state.Branch,\n      name:this.state.Name,\n      date:moment().format('YYYY-MM-DD'),\n      time:moment().format('hh:mm'),\n      stock:this.state.data\n    })\n    .then( (response) => {\n      console.log(response);\n      window.sessionStorage.setItem('lastupload',moment().format('YYYY-MM-DD'));\n      openNotificationWithIcon('success')\n      \n      //set last upload date\n     /* axios.put(baseURL+'/User/updateUploaddate/'+window.sessionStorage.getItem('auto_increment'),{\n        date:moment().format('YYYY-MM-DD')\n      })\n      .then( (response) => {\n        console.log(response);\n      })\n      .catch( (error) => {\n        console.log(error);\n      });*/\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  componentWillMount() {\n    console.log('componentWillMount');\n      axios.get(baseURL+'/ShopData/getLastStock',\n        {\n          params: {\n            shop : window.localStorage.getItem('shopname'),\n            branch : window.localStorage.getItem('branch')\n          }\n        }\n      )\n      .then( (response) =>{\n      for(var index in response.data){\n        response.data[index].scrap = 0;\n      }\n      this.setState({data:response.data,\n        Shop:window.localStorage.getItem('shopname'),\n        Name:window.localStorage.getItem('name'),\n        Branch:window.localStorage.getItem('branch'),\n        isAuth:window.sessionStorage.getItem('isAuth'),\n        Permission:window.sessionStorage.getItem('permission')\n      });\n    })\n    .catch(function (error) {\n      console.log(error);\n    }); \n    axios.get(baseURL+'/ShopData/getLastExpense',\n    {\n      params: {\n        shop: window.localStorage.getItem('shopname'),\n        branch: window.localStorage.getItem('branch')\n      }\n    })\n    .then( (response) => {\n      for(var index in response.data){\n        response.data[index].cost = 0;\n      }\n      this.setState({expense:response.data});\n    })\n    .catch(function (error) {\n      console.log(error);\n    }); \n    this.setState({UploadDisable:false});\n  }\n  componentDidMount(){\n    console.log('componentdDidMount');\n    console.log(moment().format('YYYY-MM-DD hh:mm'))\n  }\n  componentDidUpdate(){\n    console.log('componentDidUpdate');\n  }\n}\n\n\nexport default UserPage;\n"]},"metadata":{},"sourceType":"module"}