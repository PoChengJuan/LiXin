{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Documents/React/LiXin/src/FrontEnd/Container/User.js\";\nimport React from 'react';\nimport './User.css';\nimport { Row, Col, Layout, Button } from 'antd';\nimport { List, Icon, InputNumber, notification } from 'antd';\nimport axios from 'axios';\nimport NumericInput from '../Components/InputNumber';\nimport { Redirect } from \"react-router-dom\";\nimport moment from 'moment';\nimport baseURL from '../Components/AxiosAPI';\nimport InfoIcom from '../Components/InfoIcon';\nconst Header = Layout.Header,\n      Content = Layout.Content;\n\nconst openNotificationWithIcon = type => {\n  notification[type]({\n    message: '上傳成功'\n  });\n};\n/*const User = (\n  <div>\n    <p>姓名：</p>\n    <p>位置：康樂總店</p>\n    <p>人員：開發者</p>\n  </div>\n);*/\n//var expense =[\n// '支出'\n//];\n\n\nvar income = ['營業額'];\n\nclass UserPage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.StockValueStore = (item, Num) => {\n      const data = this.state.data;\n      console.log('===', Num);\n      data.forEach(data => {\n        if (data.key === item.key) {\n          data.stock = Num;\n        }\n      });\n      this.setState({\n        data\n      });\n    };\n\n    this.OrderValueStore = (item, Num) => {\n      const data = this.state.data;\n      console.log('order:', Num);\n      data.forEach(data => {\n        if (data.key === item.key) {\n          data.order = Num;\n        }\n      });\n      this.setState({\n        data\n      });\n    };\n\n    this.ExpenseValueStore = (item, Num) => {\n      const expense = this.state.expense;\n      console.log('expense:', Num);\n      expense.forEach(expense => {\n        if (expense.key === item.key) {\n          expense.cost = Num;\n        }\n      });\n      this.setState({\n        expense\n      });\n    };\n\n    this.IncomStore = income => {\n      this.setState({\n        Income: income\n      });\n    };\n\n    this.DataUpdata = Update => {\n      this.setState({\n        Update: true\n      });\n    };\n\n    this.state = {\n      isAuth: '',\n      UploadDisable: true,\n      data: '',\n      expense: '',\n      Income: '',\n      Shop: '',\n      Name: '',\n      Branch: '',\n      Permission: '',\n      Position: '',\n      Display: false,\n      MainPage: false,\n      ScrapPage: false,\n      Update: false\n    };\n  }\n\n  MainFnction(e) {\n    this.setState({\n      MainPage: true\n    });\n  }\n\n  ScrapFunction(e) {\n    this.setState({\n      ScrapPage: true\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          data = _this$state.data,\n          expense = _this$state.expense,\n          isAuth = _this$state.isAuth,\n          MainPage = _this$state.MainPage,\n          ScrapPage = _this$state.ScrapPage;\n\n    if (isAuth === 'false') {\n      console.log('logout');\n      return React.createElement(Redirect, {\n        to: '/',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      });\n    } else if (MainPage === true) {\n      return React.createElement(Redirect, {\n        to: 'Main',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      });\n    } else if (ScrapPage === true) {\n      return React.createElement(Redirect, {\n        to: 'Scrap',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      });\n    }\n\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(Layout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, React.createElement(Col, {\n      span: 24,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, React.createElement(Header, {\n      className: \"Header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, this.state.Display && React.createElement(Icon, {\n      type: \"delete\",\n      theme: \"filled\",\n      className: \"delete\",\n      style: {\n        fontSize: '1cm',\n        color: '#ff0011'\n      },\n      onClick: this.ScrapFunction.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }), React.createElement(InfoIcom, {\n      name: window.localStorage.getItem('name'),\n      branch: window.localStorage.getItem('branch'),\n      permission: window.sessionStorage.getItem('permission'),\n      shape: \"circle\",\n      size: 60,\n      dropdown: true,\n      shopchange: this.DataUpdata,\n      logout: () => this.LogoutFunction(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }), this.state.Display && React.createElement(Icon, {\n      type: \"bar-chart\",\n      className: \"analyze\",\n      style: {\n        fontSize: '1cm',\n        color: '#08c'\n      },\n      onClick: this.MainFnction.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    })))), React.createElement(Col, {\n      span: 24,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, React.createElement(Content, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"Content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"ListName\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(List, {\n      bordered: true,\n      dataSource: data,\n      renderItem: item => React.createElement(List.Item, {\n        key: item.key,\n        actions: [React.createElement(InputNumber, {\n          key: item.key,\n          className: \"Number\",\n          value: item.stock,\n          onChange: value => this.StockValueStore(item, value),\n          defaultValue: \"0\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        }), React.createElement(InputNumber, {\n          key: item.key,\n          className: \"Order\",\n          value: item.order,\n          placeholder: \"\\u53EB\\u8CA8\",\n          onChange: value => this.OrderValueStore(item, value),\n          decimalSeparator: \".\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        })],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, item.title),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }), React.createElement(List, {\n      bordered: true,\n      dataSource: expense,\n      renderItem: item => //<List.Item actions={[<NumericInput style={{ width: 130 }} addonBefore={'NTD:'} value={this.state.Expense} onChange={(value)=>this.ExpenseStore(value)}  />]}>\n      // {'支出'} \n      //</List.Item>\n      React.createElement(List.Item, {\n        key: item.key,\n        actions: [React.createElement(NumericInput, {\n          style: {\n            width: 130\n          },\n          key: item.key,\n          addonBefore: 'NTD:',\n          value: item.cost,\n          onChange: value => this.ExpenseValueStore(item, value),\n          defaultValue: \"0\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }) //<InputNumber key={item.key} className=\"Number\" value={item.cost} onChange={(value) => this.ExpenseValueStore(item,value)} defaultValue='0'/>\n        ],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, item.title),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }), React.createElement(List, {\n      bordered: true,\n      dataSource: income,\n      renderItem: item => React.createElement(List.Item, {\n        actions: [React.createElement(NumericInput, {\n          style: {\n            width: 130\n          },\n          addonBefore: 'NTD:',\n          value: this.state.Income,\n          onChange: value => this.IncomStore(value),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        })],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, '營業額'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    })), React.createElement(Button, {\n      type: \"primary\",\n      className: \"Upload\",\n      disabled: this.state.UploadDisable,\n      onClick: this.UploadFunction.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, \"\\u4E0A\\u50B3\")))))));\n  }\n\n  LogoutFunction() {\n    this.setState({\n      isAuth: 'false'\n    });\n    window.sessionStorage.setItem('isAuth', 'false');\n  }\n\n  UploadFunction(event) {\n    axios.get(baseURL + '/ShopData/getTodayData', {\n      params: {\n        shopname: window.localStorage.getItem('shopname'),\n        branch: window.localStorage.getItem('branch'),\n        today: moment().format('YYYY-MM-DD')\n      }\n    }).then(response => {\n      console.log(response.data);\n\n      if (response.data.length === 0) {\n        /*****No Data (Post)********************/\n        axios.post(baseURL + '/ShopData/add', {\n          shopname: window.localStorage.getItem('shopname'),\n          branch: window.localStorage.getItem('branch'),\n          name: window.localStorage.getItem('name'),\n          date: moment().format('YYYY-MM-DD'),\n          time: moment().format('hh:mm'),\n          stock: this.state.data,\n          expense: this.state.expense,\n          income: this.state.Income\n        }).then(response => {\n          console.log(response); //Owner can upload multi time\n\n          if (window.sessionStorage.getItem('permission') < 7) {\n            this.setState({\n              UploadDisable: true\n            }); //set last upload date\n\n            axios.put(baseURL + '/User/updateUploaddate/' + window.sessionStorage.getItem('auto_increment'), {\n              date: moment().format('YYYY-MM-DD')\n            }).then(response => {\n              console.log(response);\n            }).catch(error => {\n              console.log(error);\n            });\n          }\n\n          console.log('success');\n          window.sessionStorage.setItem('lastupload', moment().format('YYYY-MM-DD'));\n          openNotificationWithIcon('success');\n        }).catch(function (error) {\n          console.log(error);\n        });\n      } else {\n        /*****Update Data (Put)******************/\n        axios.put(baseURL + '/ShopData/UpdateStock/' + response.data[0], {\n          name: window.localStorage.getItem('name'),\n          time: moment().format('hh:mm'),\n          stock: this.state.data,\n          expense: this.state.expense,\n          income: this.state.Income,\n          type: \"stock\"\n        }).then(response => {\n          console.log(response);\n          openNotificationWithIcon('success');\n        }).catch(error => {\n          console.log(error);\n        });\n      }\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  componentWillMount() {\n    console.log('componentWillMount');\n\n    if (window.sessionStorage.getItem('isAuth') === null) {\n      this.setState({\n        isAuth: 'false'\n      });\n    }\n\n    axios.get(baseURL + '/ShopData/getLastStock', {\n      params: {\n        shop: window.localStorage.getItem('shopname'),\n        branch: window.localStorage.getItem('branch')\n      }\n    }).then(response => {\n      for (var index in response.data) {\n        response.data[index].order = 0;\n        response.data[index].scrap = 0;\n      }\n\n      this.setState({\n        data: response.data,\n        Branch: window.localStorage.getItem('branch'),\n        isAuth: window.sessionStorage.getItem('isAuth'),\n        Permission: window.sessionStorage.getItem('permission')\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n    axios.get(baseURL + '/ShopData/getLastExpense', {\n      params: {\n        shop: window.localStorage.getItem('shopname'),\n        branch: window.localStorage.getItem('branch')\n      }\n    }).then(response => {\n      for (var index in response.data) {\n        response.data[index].cost = 0;\n      }\n\n      this.setState({\n        expense: response.data\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n\n    if (window.sessionStorage.getItem('permission') === '9') {\n      this.setState({\n        Position: '開發者',\n        Display: true\n      });\n    } else if (window.sessionStorage.getItem('permission') === '7') {\n      this.setState({\n        Position: '老闆',\n        //Display:false\n        Display: true\n      });\n    } else if (window.sessionStorage.getItem('permission') === '5') {\n      this.setState({\n        Position: '店長'\n      });\n    } else {\n      this.setState({\n        Position: '人員'\n      });\n    } //console.log(window.sessionStorage.getItem('date'))\n    //console.log(moment().format('MM-DD'))\n    //One day only upload one time\n    //Upload Function only enable in 4pm ~ 5pm\n\n\n    console.log(window.sessionStorage.getItem('isAuth')); //console.log(window.sessionStorage.getItem('lastupload'))\n    //console.log(moment().format('YYYY-MM-DD'))\n    //if(window.sessionStorage.getItem('isupload') === 'false'){\n\n    if (window.sessionStorage.getItem('lastupload') !== moment().format('YYYY-MM-DD')) {\n      if (moment().format('HH') === '16' || moment().format('HH') === '17' || moment().format('HH') === '18' || moment().format('HH') === '19' || moment().format('HH') === '20' || moment().format('HH') === '21') {\n        this.setState({\n          UploadDisable: false\n        });\n      }\n    }\n\n    this.setState({\n      UploadDisable: false\n    }); //if(window.sessionStorage.getItem('uploadagain') === 'true'){\n    //  this.setState({UploadDisable:false});\n    //}\n  }\n\n  componentDidMount() {\n    console.log('componentdDidMount');\n    console.log(moment().format('YYYY-MM-DD hh:mm'));\n  }\n\n  componentDidUpdate() {\n    console.log('componentDidUpdate');\n\n    if (this.state.Update === true) {\n      axios.get(baseURL + '/ShopData/getLastStock', {\n        params: {\n          shop: window.localStorage.getItem('shopname'),\n          branch: window.localStorage.getItem('branch')\n        }\n      }).then(response => {\n        if (response.data !== []) {\n          for (var index in response.data) {\n            response.data[index].order = 0;\n            response.data[index].scrap = 0;\n          }\n\n          this.setState({\n            data: response.data,\n            Branch: window.localStorage.getItem('branch'),\n            UploadDisable: false\n          });\n        } else {\n          console.log('test 1');\n          this.setState({\n            data: '',\n            Branch: window.localStorage.getItem('branch')\n          });\n        }\n      }).catch(error => {\n        console.log(error);\n        console.log('test 2');\n        this.setState({\n          data: '',\n          Branch: window.localStorage.getItem('branch'),\n          UploadDisable: true\n        });\n      });\n      axios.get(baseURL + '/ShopData/getLastExpense', {\n        params: {\n          shop: window.localStorage.getItem('shopname'),\n          branch: window.localStorage.getItem('branch')\n        }\n      }).then(response => {\n        if (response.data !== []) {\n          for (var index in response.data) {\n            response.data[index].cost = 0;\n          }\n\n          this.setState({\n            expense: response.data\n          });\n        } else {\n          console.log('test 3');\n          this.setState({\n            expense: '',\n            UploadDisable: true\n          });\n        }\n      }).catch(error => {\n        console.log(error);\n        console.log('test 4');\n        this.setState({\n          expense: '',\n          UploadDisable: true\n        });\n      });\n      this.setState({\n        Update: false\n      });\n    }\n  }\n\n}\n\nexport default UserPage;","map":{"version":3,"sources":["/Users/mac/Documents/React/LiXin/src/FrontEnd/Container/User.js"],"names":["React","Row","Col","Layout","Button","List","Icon","InputNumber","notification","axios","NumericInput","Redirect","moment","baseURL","InfoIcom","Header","Content","openNotificationWithIcon","type","message","income","UserPage","Component","constructor","props","StockValueStore","item","Num","data","state","console","log","forEach","key","stock","setState","OrderValueStore","order","ExpenseValueStore","expense","cost","IncomStore","Income","DataUpdata","Update","isAuth","UploadDisable","Shop","Name","Branch","Permission","Position","Display","MainPage","ScrapPage","MainFnction","e","ScrapFunction","render","fontSize","color","bind","window","localStorage","getItem","sessionStorage","LogoutFunction","value","title","width","UploadFunction","setItem","event","get","params","shopname","branch","today","format","then","response","length","post","name","date","time","put","catch","error","componentWillMount","shop","index","scrap","componentDidMount","componentDidUpdate"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './User.css'\nimport { Row, Col, Layout, Button } from 'antd';\nimport { List, Icon, InputNumber,notification } from 'antd';\nimport axios from 'axios'\nimport NumericInput from'../Components/InputNumber'\nimport {Redirect,} from \"react-router-dom\";\nimport moment from 'moment';\nimport baseURL from '../Components/AxiosAPI'\nimport InfoIcom from '../Components/InfoIcon'\n\nconst { Header, Content } = Layout;\n\nconst openNotificationWithIcon = type => {\n  notification[type]({\n    message: '上傳成功',\n  });\n};\n\n/*const User = (\n  <div>\n    <p>姓名：</p>\n    <p>位置：康樂總店</p>\n    <p>人員：開發者</p>\n  </div>\n);*/\n//var expense =[\n // '支出'\n//];\nvar income = [\n  '營業額'\n];\nclass UserPage extends React.Component{\n  constructor(props){\n    super(props);\n    this.state = {\n      isAuth: '',\n      UploadDisable:true,\n      data:'',\n      expense:'',\n      Income:'',\n      Shop:'',\n      Name:'',\n      Branch:'',\n      Permission:'',\n      Position:'',\n      Display:false,\n      MainPage:false,\n      ScrapPage:false,\n      Update:false\n    }      \n  }\n  StockValueStore  = (item ,Num) => {\n    const {data} = this.state;\n    console.log('===', Num);\n      data.forEach(data => {\n      if (data.key === item.key) {\n        data.stock = Num;\n      }\n    });\n    this.setState({ data });\n  }\n  OrderValueStore = (item, Num)=>{\n    const {data} = this.state;\n    console.log('order:',Num);\n    data.forEach(data=>{\n      if(data.key === item.key){\n        data.order = Num\n      }\n    })\n    this.setState({ data });\n  }\n  ExpenseValueStore = (item, Num) => {\n    const {expense} = this.state;\n    console.log('expense:',Num);\n    expense.forEach(expense=>{\n      if(expense.key === item.key){\n        expense.cost = Num\n      }\n    })\n    this.setState({expense});\n\n  }\n  IncomStore = (income) =>{\n    this.setState({Income:income})\n  }\n  MainFnction(e){\n    this.setState({MainPage:true})\n  }\n  ScrapFunction(e){\n    this.setState({ScrapPage:true})\n  }\n  render(){\n    const { data,expense,isAuth,MainPage,ScrapPage } = this.state;\n    if(isAuth === 'false'){\n      console.log('logout');\n      return <Redirect to={'/'} />\n    }else if(MainPage === true){\n      return <Redirect to={'Main'} />\n    }else if(ScrapPage === true){\n      return <Redirect to={'Scrap'} />\n    }\n    return(\n      <div className=\"App\">\n        <Row>\n          <Layout>\n            <Col span={24}>\n              <Header className=\"Header\">\n                <div>\n                  {this.state.Display &&\n                    <Icon type=\"delete\" theme=\"filled\" className='delete' style={{fontSize:'1cm',color:'#ff0011'}} onClick={this.ScrapFunction.bind(this)} />\n                  }\n                  <InfoIcom \n                        name={window.localStorage.getItem('name')}\n                        branch={window.localStorage.getItem('branch')}\n                        permission = {window.sessionStorage.getItem('permission')}\n                        shape='circle'\n                        size={60}\n                        dropdown = {true}\n                        shopchange = {this.DataUpdata}\n                        logout={()=>this.LogoutFunction()}\n                    />\n                  {this.state.Display &&\n                    <Icon type=\"bar-chart\" className='analyze' style={{fontSize:'1cm',color:'#08c'}} onClick={this.MainFnction.bind(this)} />\n                  }\n                </div>\n              </Header>\n            </Col>\n            <Col span={24}>\n              <Content>\n                <div className=\"Content\">\n                  <div className=\"ListName\">\n                    <List \n                      bordered\n                      dataSource={data}\n                      renderItem={item => (\n                        <List.Item key={item.key} actions={\n                          [<InputNumber key={item.key} className=\"Number\" value={item.stock} onChange={(value) => this.StockValueStore(item,value)} defaultValue='0'/>,\n                          <InputNumber key={item.key} className=\"Order\" value={item.order} placeholder=\"叫貨\" onChange={(value)=>this.OrderValueStore(item,value)} decimalSeparator=\".\" />]\n                          }>\n                          {item.title}\n                        </List.Item>\n                      )}\n                    />\n                    <List\n                      bordered\n                      dataSource={expense}\n                      renderItem={item=>(\n                        //<List.Item actions={[<NumericInput style={{ width: 130 }} addonBefore={'NTD:'} value={this.state.Expense} onChange={(value)=>this.ExpenseStore(value)}  />]}>\n                         // {'支出'} \n                        //</List.Item>\n                        <List.Item key={item.key} actions={\n                          [<NumericInput style={{ width: 130 }} key={item.key} addonBefore={'NTD:'} value={item.cost} onChange={(value) => this.ExpenseValueStore(item,value)} defaultValue='0' />\n                          //<InputNumber key={item.key} className=\"Number\" value={item.cost} onChange={(value) => this.ExpenseValueStore(item,value)} defaultValue='0'/>\n                        ]\n                          }>\n                          {item.title}\n                        </List.Item>\n                      )}\n                    />\n                    <List\n                      bordered\n                      dataSource={income}\n                      renderItem={item=>(\n                        <List.Item actions={[<NumericInput style={{ width: 130 }} addonBefore={'NTD:'} value={this.state.Income} onChange={(value)=>this.IncomStore(value)}  />]}>\n                          {'營業額'} \n                        </List.Item>\n                      )}\n                    />\n                  </div>\n                  <Button type=\"primary\" className=\"Upload\" disabled = {this.state.UploadDisable} onClick={this.UploadFunction.bind(this)}>上傳</Button>\n                </div>\n              </Content>\n            </Col>\n          </Layout>\n        </Row>\n      </div>\n    )\n  }\n  DataUpdata=(Update)=>{\n    this.setState({Update:true})\n  }\n  LogoutFunction(){\n    this.setState({isAuth:'false'});\n    window.sessionStorage.setItem('isAuth','false');\n  }\n  UploadFunction(event){    \n    axios.get(baseURL+'/ShopData/getTodayData',\n    {\n      params: {\n        shopname: window.localStorage.getItem('shopname'),\n        branch: window.localStorage.getItem('branch'),\n        today: moment().format('YYYY-MM-DD')\n      }\n    })\n    .then( (response) =>{\n      console.log(response.data);\n      if(response.data.length === 0){\n        /*****No Data (Post)********************/\n        axios.post(baseURL+'/ShopData/add', {\n          shopname: window.localStorage.getItem('shopname'),\n          branch : window.localStorage.getItem('branch'),\n          name:window.localStorage.getItem('name'),\n          date:moment().format('YYYY-MM-DD'),\n          time:moment().format('hh:mm'),\n          stock:this.state.data,\n          expense:this.state.expense,\n          income:this.state.Income\n        })\n        .then( (response) => {\n          console.log(response);\n          //Owner can upload multi time\n          if(window.sessionStorage.getItem('permission') < 7){\n            this.setState({UploadDisable:true})\n            //set last upload date\n            axios.put(baseURL+'/User/updateUploaddate/'+window.sessionStorage.getItem('auto_increment'),{\n              date:moment().format('YYYY-MM-DD')\n            })\n            .then( (response) => {\n              console.log(response);\n            })\n            .catch( (error) => {\n              console.log(error);\n            });\n          }\n          console.log('success')\n          window.sessionStorage.setItem('lastupload',moment().format('YYYY-MM-DD'));\n          openNotificationWithIcon('success')\n        })\n        .catch(function (error) {\n          console.log(error);\n        });\n      }else{\n        /*****Update Data (Put)******************/\n        axios.put(baseURL+'/ShopData/UpdateStock/'+response.data[0],{\n          name:window.localStorage.getItem('name'),\n          time:moment().format('hh:mm'),\n          stock:this.state.data,\n          expense:this.state.expense,\n          income:this.state.Income,\n          type:\"stock\"\n        })\n        .then( (response) => {\n          console.log(response);\n          openNotificationWithIcon('success');\n        })\n        .catch( (error) => {\n          console.log(error);\n        });\n      }\n    })\n    .catch( (error) => {\n      console.log(error);\n    })\n    \n    \n  }\n\n  componentWillMount() {\n    console.log('componentWillMount');\n    if(window.sessionStorage.getItem('isAuth') === null){\n      this.setState({isAuth:'false'})\n    }\n    axios.get(baseURL+'/ShopData/getLastStock',\n      {\n        params: {\n          shop : window.localStorage.getItem('shopname'),\n          branch : window.localStorage.getItem('branch')\n        }\n      }\n    )\n    .then( (response) =>{\n      for(var index in response.data){\n        response.data[index].order = 0;\n        response.data[index].scrap = 0;\n      }\n      this.setState({\n        data:response.data,\n        Branch:window.localStorage.getItem('branch'),\n        isAuth:window.sessionStorage.getItem('isAuth'),\n        Permission:window.sessionStorage.getItem('permission')\n      });\n    })\n    .catch(function (error) {\n      console.log(error);\n    }); \n    \n    axios.get(baseURL+'/ShopData/getLastExpense',\n    {\n      params: {\n        shop: window.localStorage.getItem('shopname'),\n        branch: window.localStorage.getItem('branch')\n      }\n    })\n    .then( (response) => {\n      for(var index in response.data){\n        response.data[index].cost = 0;\n      }\n      this.setState({expense:response.data});\n    })\n    .catch(function (error) {\n      console.log(error);\n    }); \n\n    if(window.sessionStorage.getItem('permission') === '9'){\n      this.setState({Position:'開發者',\n      Display:true});\n    }else if(window.sessionStorage.getItem('permission') === '7'){\n      this.setState({Position:'老闆',\n      //Display:false\n      Display:true\n    });\n    }else if(window.sessionStorage.getItem('permission') === '5'){\n      this.setState({Position:'店長'});\n    }else{\n      this.setState({Position:'人員'});\n    }\n    //console.log(window.sessionStorage.getItem('date'))\n    //console.log(moment().format('MM-DD'))\n    //One day only upload one time\n      //Upload Function only enable in 4pm ~ 5pm\n      console.log(window.sessionStorage.getItem('isAuth'))\n\n    //console.log(window.sessionStorage.getItem('lastupload'))\n    //console.log(moment().format('YYYY-MM-DD'))\n    //if(window.sessionStorage.getItem('isupload') === 'false'){\n    if(window.sessionStorage.getItem('lastupload') !== moment().format('YYYY-MM-DD')){\n      if((moment().format('HH')==='16') || (moment().format('HH')==='17') ||\n         (moment().format('HH')==='18') || (moment().format('HH')==='19') ||\n         (moment().format('HH')==='20') || (moment().format('HH')==='21')\n      ){        \n        this.setState({UploadDisable:false});\n      } \n    }this.setState({UploadDisable:false});\n    //if(window.sessionStorage.getItem('uploadagain') === 'true'){\n    //  this.setState({UploadDisable:false});\n    //}\n  }\n  componentDidMount(){\n    console.log('componentdDidMount');\n    console.log(moment().format('YYYY-MM-DD hh:mm'))\n  }\n  componentDidUpdate(){\n    console.log('componentDidUpdate');\n    if(this.state.Update === true){\n      axios.get(baseURL+'/ShopData/getLastStock',\n        {\n          params: {\n            shop : window.localStorage.getItem('shopname'),\n            branch : window.localStorage.getItem('branch')\n          }\n        }\n      )\n      .then( (response) =>{\n        if(response.data !== []){\n          for(var index in response.data){\n            response.data[index].order = 0;\n            response.data[index].scrap = 0;\n          }\n          this.setState({\n            data:response.data,\n            Branch:window.localStorage.getItem('branch'),\n            UploadDisable:false\n          });\n        }else{\n          console.log('test 1')\n          this.setState({\n            data:'',\n            Branch:window.localStorage.getItem('branch'),\n          });\n        }\n      })\n      .catch( (error) => {\n        console.log(error);\n        console.log('test 2')\n\n        this.setState({\n          data:'',\n          Branch:window.localStorage.getItem('branch'),\n          UploadDisable:true\n        });\n      }); \n      \n      axios.get(baseURL+'/ShopData/getLastExpense',\n      {\n        params: {\n          shop: window.localStorage.getItem('shopname'),\n          branch: window.localStorage.getItem('branch')\n        }\n      })\n      .then( (response) => {\n        if(response.data !== []){\n          for(var index in response.data){\n            response.data[index].cost = 0;\n          }\n          this.setState({expense:response.data});\n        }else{\n          console.log('test 3')\n\n          this.setState({\n            expense:'',\n            UploadDisable:true});\n        }\n      })\n      .catch( (error) => {\n        console.log(error);\n        console.log('test 4')\n\n        this.setState({\n          expense:'',\n          UploadDisable:true});\n      }); \n      this.setState({Update:false})\n    }\n  }\n}\n\n\nexport default UserPage;\n"]},"metadata":{},"sourceType":"module"}