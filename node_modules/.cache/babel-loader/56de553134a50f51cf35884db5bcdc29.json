{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Documents/React/workspace/src/FrontEnd/Container/Scrap.js\";\nimport React from 'react';\nimport './Scrap.css';\nimport { Row, Col, Layout, Button } from 'antd';\nimport { List, Icon, Popover, Avatar, InputNumber, notification, Switch } from 'antd';\nimport axios from 'axios';\nimport NumericInput from '../Components/InputNumber';\nimport { BrowserRouter as Router, Redirect } from \"react-router-dom\";\nimport moment from 'moment';\nimport baseURL from '../Components/AxiosAPI';\nimport InfoIcom from '../Components/InfoIcon';\nconst Header = Layout.Header,\n      Content = Layout.Content;\n\nconst openNotificationWithIcon = type => {\n  notification[type]({\n    message: '上傳成功'\n  });\n};\n\nvar income = ['營業額'];\n\nclass ScrapPage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.ScrapValueStore = (item, Num) => {\n      const data = this.state.data;\n      data.forEach(data => {\n        if (data.key === item.key) {\n          data.scrap = Num;\n        }\n      });\n      this.setState({\n        data\n      });\n    };\n\n    this.DataUpdata = Update => {\n      this.setState({\n        Update: true\n      });\n    };\n\n    this.Getdata = () => {};\n\n    this.state = {\n      isAuth: '',\n      UploadDisable: true,\n      data: '',\n      expense: '',\n      Income: '',\n      Shop: '',\n      Name: '',\n      Branch: '',\n      Permission: '',\n      Position: '',\n      Display: false,\n      MainPage: false,\n      UserPage: false,\n      Update: false\n    };\n  }\n\n  LogoutFunction() {\n    this.setState({\n      isAuth: 'false'\n    });\n    window.sessionStorage.setItem('isAuth', 'false');\n  }\n\n  MainFnction(e) {\n    this.setState({\n      MainPage: true\n    });\n  }\n\n  UserFunction(e) {\n    this.setState({\n      UserPage: true\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          data = _this$state.data,\n          isAuth = _this$state.isAuth,\n          MainPage = _this$state.MainPage,\n          UserPage = _this$state.UserPage;\n\n    if (isAuth === 'false') {\n      console.log('logout');\n      return React.createElement(Redirect, {\n        to: '/',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      });\n    } else if (MainPage === true) {\n      return React.createElement(Redirect, {\n        to: 'Main',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      });\n    } else if (UserPage === true) {\n      return React.createElement(Redirect, {\n        to: 'User',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      });\n    }\n\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(Layout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, React.createElement(Col, {\n      span: 24,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, React.createElement(Header, {\n      className: \"Header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"bars\",\n      className: \"store\",\n      style: {\n        fontSize: '1cm',\n        color: '#08c'\n      },\n      onClick: this.UserFunction.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }), React.createElement(InfoIcom, {\n      name: window.localStorage.getItem('name'),\n      branch: window.localStorage.getItem('branch'),\n      permission: window.sessionStorage.getItem('permission'),\n      shape: \"circle\",\n      size: 60,\n      dropdown: true,\n      shopchange: this.DataUpdata,\n      logout: () => this.LogoutFunction(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }), React.createElement(Icon, {\n      type: \"bar-chart\",\n      className: \"analyze\",\n      style: {\n        fontSize: '1cm',\n        color: '#08c'\n      },\n      onClick: this.MainFnction.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    })))), React.createElement(Col, {\n      span: 24,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(Content, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"Content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"ListName\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(List, {\n      bordered: true,\n      dataSource: data,\n      renderItem: item => React.createElement(List.Item, {\n        key: item.key,\n        actions: [React.createElement(InputNumber, {\n          key: item.key,\n          className: \"Scrap\",\n          value: item.scrap,\n          placeholder: \"\\u53EB\\u8CA8\",\n          onChange: value => this.ScrapValueStore(item, value),\n          decimalSeparator: \".\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105\n          },\n          __self: this\n        })],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, item.title),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"deleteSw\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(Switch, {\n      checked: this.state.deleteSw,\n      onChange: this.deleteSwFunc.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"deleteBtn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, React.createElement(Button, {\n      disabled: this.state.UploadDisable,\n      type: \"danger\",\n      className: \"Upload\",\n      onClick: this.UploadFunction.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"delete\",\n      style: {\n        fontSize: '0.7cm'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    })))))))));\n  }\n\n  deleteSwFunc(checked) {\n    console.log(checked);\n\n    if (checked === true) {\n      this.setState({\n        UploadDisable: false,\n        deleteSw: true\n      });\n    } else if (checked === false) {\n      this.setState({\n        UploadDisable: true,\n        deleteSw: false\n      });\n    }\n  }\n\n  UploadFunction(event) {\n    console.log(this.state.Shop);\n    this.setState({\n      UploadDisable: true,\n      deleteSw: false\n    });\n    axios.get(baseURL + '/ShopData/getTodayData', {\n      params: {\n        shopname: this.state.Shop,\n        branch: window.localStorage.getItem('branch'),\n        today: moment().format('YYYY-MM-DD')\n      }\n    }).then(response => {\n      console.log(response.data);\n\n      if (response.data.length === 0) {\n        // No Data\n        console.log(\"false\");\n        axios.post(baseURL + '/ShopData/add', {\n          shopname: this.state.Shop,\n          branch: window.localStorage.getItem('branch'),\n          name: this.state.Name,\n          date: moment().format('YYYY-MM-DD'),\n          time: moment().format('hh:mm'),\n          stock: this.state.data,\n          expense: this.state.expense,\n          income: this.state.Income\n        }).then(response => {\n          console.log(response); //window.sessionStorage.setItem('lastupload',moment().format('YYYY-MM-DD'));\n        }).catch(function (error) {\n          console.log(error);\n        });\n      } else {\n        // Updata\n        console.log(this.state.Name);\n        console.log(moment().format('hh:mm'));\n        console.log(this.state.data);\n        axios.put(baseURL + '/ShopData/UpdateScrap/' + response.data[0], {\n          name: this.state.Name,\n          time: moment().format('hh:mm'),\n          stock: this.state.data\n        }).then(response => {\n          console.log(response);\n          openNotificationWithIcon('success');\n        }).catch(error => {\n          console.log(error);\n        });\n      }\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  componentWillMount() {\n    console.log('componentWillMount');\n    axios.get(baseURL + '/ShopData/getLastStock', {\n      params: {\n        shop: window.localStorage.getItem('shopname'),\n        branch: window.localStorage.getItem('branch')\n      }\n    }).then(response => {\n      for (var index in response.data) {\n        response.data[index].stock = 0;\n        response.data[index].order = 0;\n        response.data[index].scrap = 0;\n      }\n\n      this.setState({\n        data: response.data,\n        Branch: window.localStorage.getItem('branch')\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n    axios.get(baseURL + '/ShopData/getLastExpense', {\n      params: {\n        shop: window.localStorage.getItem('shopname'),\n        branch: window.localStorage.getItem('branch')\n      }\n    }).then(response => {\n      for (var index in response.data) {\n        response.data[index].cost = 0;\n      }\n\n      this.setState({\n        expense: response.data\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  componentDidMount() {\n    console.log('componentdDidMount');\n    console.log(moment().format('YYYY-MM-DD hh:mm'));\n  }\n\n  componentDidUpdate() {\n    console.log('componentDidUpdate');\n\n    if (this.state.Update === true) {\n      axios.get(baseURL + '/ShopData/getLastStock', {\n        params: {\n          shop: window.localStorage.getItem('shopname'),\n          branch: window.localStorage.getItem('branch')\n        }\n      }).then(response => {\n        console.log(response.data);\n\n        if (response.data !== []) {\n          for (var index in response.data) {\n            response.data[index].stock = 0;\n            response.data[index].order = 0;\n            response.data[index].scrap = 0;\n          }\n\n          this.setState({\n            data: response.data,\n            Branch: window.localStorage.getItem('branch'),\n            Update: false\n          });\n        } else {\n          this.setState({\n            data: '',\n            Name: window.localStorage.getItem('branch'),\n            Update: false\n          });\n        }\n      }).catch(error => {\n        console.log(error);\n        this.setState({\n          data: '',\n          Branch: window.localStorage.getItem('branch'),\n          Update: false\n        });\n      });\n    }\n  }\n\n}\n\nexport default ScrapPage;","map":{"version":3,"sources":["/Users/mac/Documents/React/workspace/src/FrontEnd/Container/Scrap.js"],"names":["React","Row","Col","Layout","Button","List","Icon","Popover","Avatar","InputNumber","notification","Switch","axios","NumericInput","BrowserRouter","Router","Redirect","moment","baseURL","InfoIcom","Header","Content","openNotificationWithIcon","type","message","income","ScrapPage","Component","constructor","props","ScrapValueStore","item","Num","data","state","forEach","key","scrap","setState","DataUpdata","Update","Getdata","isAuth","UploadDisable","expense","Income","Shop","Name","Branch","Permission","Position","Display","MainPage","UserPage","LogoutFunction","window","sessionStorage","setItem","MainFnction","e","UserFunction","render","console","log","fontSize","color","bind","localStorage","getItem","value","title","deleteSw","deleteSwFunc","UploadFunction","checked","event","get","params","shopname","branch","today","format","then","response","length","post","name","date","time","stock","catch","error","put","componentWillMount","shop","index","order","cost","componentDidMount","componentDidUpdate"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './Scrap.css'\nimport { Row, Col, Layout, Button } from 'antd';\nimport { List, Icon, Popover, Avatar, InputNumber,notification,Switch } from 'antd';\nimport axios from 'axios'\nimport NumericInput from'../Components/InputNumber'\nimport {BrowserRouter as Router,Redirect,} from \"react-router-dom\";\nimport moment from 'moment';\nimport baseURL from '../Components/AxiosAPI'\nimport InfoIcom from '../Components/InfoIcon'\nconst { Header, Content } = Layout;\n\nconst openNotificationWithIcon = type => {\n  notification[type]({\n    message: '上傳成功',\n  });\n};\n\nvar income = [\n  '營業額'\n];\nclass ScrapPage extends React.Component{\n  constructor(props){\n    super(props);\n    this.state = {\n      isAuth: '',\n      UploadDisable:true,\n      data:'',\n      expense:'',\n      Income:'',\n      Shop:'',\n      Name:'',\n      Branch:'',\n      Permission:'',\n      Position:'',\n      Display:false,\n      MainPage:false,\n      UserPage:false,\n      Update:false\n    }      \n  }\n  LogoutFunction(){\n    this.setState({isAuth:'false'});\n    window.sessionStorage.setItem('isAuth','false');\n  }\n  ScrapValueStore = (item, Num)=>{\n    const {data} = this.state;\n    data.forEach(data=>{\n      if(data.key === item.key){\n        data.scrap = Num\n      }\n    })\n    this.setState({ data });\n  }\n  DataUpdata=(Update)=>{\n    this.setState({Update:true})\n  }\n  MainFnction(e){\n    this.setState({MainPage:true})\n  }\n  UserFunction(e){\n    this.setState({UserPage:true})\n  }\n  render(){\n    const { data,isAuth,MainPage,UserPage } = this.state;\n    if(isAuth === 'false'){\n      console.log('logout');\n      return <Redirect to={'/'} />\n    }else if(MainPage === true){\n      return <Redirect to={'Main'} />\n    }else if(UserPage === true){\n      return <Redirect to={'User'} />\n    }\n    return(\n      <div className=\"App\">\n        <Row>\n          <Layout>\n            <Col span={24}>\n              <Header className=\"Header\">\n                <div>\n                    <Icon type=\"bars\" className='store' style={{fontSize:'1cm',color:'#08c'}} onClick={this.UserFunction.bind(this)} />\n                    <InfoIcom \n                        name={window.localStorage.getItem('name')}\n                        branch={window.localStorage.getItem('branch')}\n                        permission = {window.sessionStorage.getItem('permission')}\n                        shape='circle'\n                        size={60}\n                        dropdown = {true}\n                        shopchange = {this.DataUpdata}\n                        logout={()=>this.LogoutFunction()}\n                    />\n                    <Icon type=\"bar-chart\" className='analyze' style={{fontSize:'1cm',color:'#08c'}} onClick={this.MainFnction.bind(this)} />\n                </div>\n              </Header>\n            </Col>\n            <Col span={24}>\n              <Content>\n                <div className=\"Content\">\n                  <div className=\"ListName\">\n                    <List \n                      bordered\n                      dataSource={data}\n                      renderItem={item => (\n                        <List.Item key={item.key} actions={\n                          [<InputNumber key={item.key} className=\"Scrap\" value={item.scrap} placeholder=\"叫貨\" onChange={(value)=>this.ScrapValueStore(item,value)} decimalSeparator=\".\" />]\n                          }>\n                          {item.title}\n                        </List.Item>\n                      )}\n                    />\n                  </div>\n                  <div className='deleteSw'>\n                    <Switch checked={this.state.deleteSw}  onChange={this.deleteSwFunc.bind(this)} />\n                  </div>\n                  <div className='deleteBtn'>\n                    <Button disabled={this.state.UploadDisable} type=\"danger\" className=\"Upload\"  onClick={this.UploadFunction.bind(this)} ><Icon type=\"delete\" style={{fontSize:'0.7cm'}}/></Button>\n                  </div>\n                </div>\n              </Content>\n            </Col>\n          </Layout>\n        </Row>\n      </div>\n    )\n  }\n  deleteSwFunc(checked){\n    console.log(checked)\n\n    if(checked === true){\n      this.setState({\n        UploadDisable:false,\n        deleteSw:true\n      })\n    }else if(checked === false){\n      this.setState({\n        UploadDisable:true,\n        deleteSw:false\n      })\n    }\n  }\n  UploadFunction(event){\n    console.log(this.state.Shop)\n    this.setState({\n      UploadDisable:true,\n      deleteSw:false\n    })\n    axios.get(baseURL+'/ShopData/getTodayData',\n    {\n      params: {\n        shopname: this.state.Shop,\n        branch: window.localStorage.getItem('branch'),\n        today: moment().format('YYYY-MM-DD')\n      }\n    })\n    .then( (response) =>{\n      console.log(response.data);\n      if(response.data.length === 0){\n        // No Data\n        console.log(\"false\")\n        axios.post(baseURL+'/ShopData/add', {\n          shopname: this.state.Shop,\n          branch : window.localStorage.getItem('branch'),\n          name:this.state.Name,\n          date:moment().format('YYYY-MM-DD'),\n          time:moment().format('hh:mm'),\n          stock:this.state.data,\n          expense:this.state.expense,\n          income:this.state.Income\n        })\n        .then( (response) => {\n          console.log(response);\n          //window.sessionStorage.setItem('lastupload',moment().format('YYYY-MM-DD'));\n        })\n        .catch(function (error) {\n          console.log(error);\n        });\n      }else{\n        // Updata\n        console.log(this.state.Name)\n        console.log(moment().format('hh:mm'))\n        console.log(this.state.data)\n\n        axios.put(baseURL+'/ShopData/UpdateScrap/'+response.data[0],{\n          name:this.state.Name,\n          time:moment().format('hh:mm'),\n          stock:this.state.data\n        })\n        .then( (response) => {\n          console.log(response);\n          openNotificationWithIcon('success');\n        })\n        .catch( (error) => {\n          console.log(error);\n        });\n      }\n    })\n    .catch( (error) => {\n      console.log(error);\n    })    \n  }\n\n  componentWillMount() {\n    console.log('componentWillMount');\n    axios.get(baseURL+'/ShopData/getLastStock',\n      {\n        params: {\n          shop : window.localStorage.getItem('shopname'),\n          branch : window.localStorage.getItem('branch')\n        }\n      }\n    )\n    .then( (response) =>{\n      for(var index in response.data){\n        response.data[index].stock = 0;\n        response.data[index].order = 0;\n        response.data[index].scrap = 0;\n      }\n      this.setState({\n        data:response.data,\n        Branch:window.localStorage.getItem('branch'),\n      });\n    })\n    .catch(function (error) {\n      console.log(error);\n    }); \n    axios.get(baseURL+'/ShopData/getLastExpense',\n    {\n      params: {\n        shop: window.localStorage.getItem('shopname'),\n        branch: window.localStorage.getItem('branch')\n      }\n    })\n    .then( (response) => {\n      for(var index in response.data){\n        response.data[index].cost = 0;\n      }\n      this.setState({expense:response.data});\n    })\n    .catch(function (error) {\n      console.log(error);\n    }); \n  }\n  componentDidMount(){\n    console.log('componentdDidMount');\n    console.log(moment().format('YYYY-MM-DD hh:mm'))\n  }\n  componentDidUpdate(){\n    console.log('componentDidUpdate');\n    if(this.state.Update === true){\n      axios.get(baseURL+'/ShopData/getLastStock',\n        {\n          params: {\n          shop : window.localStorage.getItem('shopname'),\n          branch : window.localStorage.getItem('branch')\n        }\n      })\n      .then( (response) =>{\n        console.log(response.data)\n        if(response.data !== []){\n          for(var index in response.data){\n            response.data[index].stock = 0;\n            response.data[index].order = 0;\n            response.data[index].scrap = 0;\n          }\n          this.setState({\n            data:response.data,\n            Branch:window.localStorage.getItem('branch'),\n            Update:false\n          });\n        }else{\n          this.setState({\n            data:'',\n            Name:window.localStorage.getItem('branch'),\n            Update:false\n          });\n        }\n      })\n      .catch( (error)=>{\n        console.log(error);\n        this.setState({\n          data:'',\n          Branch:window.localStorage.getItem('branch'),\n          Update:false\n        });\n      }); \n    }\n  }\n\n  Getdata = () =>{\n    \n  }\n}\n\n\nexport default ScrapPage;\n"]},"metadata":{},"sourceType":"module"}